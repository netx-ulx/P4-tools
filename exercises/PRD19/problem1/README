For a solution to problem1 please refer to the following github repository:

https://github.com/signorello/myP4repo/tree/master/portKnockFirewall
